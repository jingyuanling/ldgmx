M.define("Imglazyload",function(a){var b=function(c){};M.object.merge(b.prototype,{lazyLad:function(){var e=this;var j=$(window).height();var h=$("img[imgsrc]");var g=$(window).scrollTop();for(var d=0,c=h.size();d<c;d++){currentObj=$(h[d]);var f=currentObj.offset().top-j-200;if(parseInt(g)>=parseInt(f)){currentObj.attr("src",currentObj.attr("imgsrc"));currentObj.removeAttr("imgsrc")}}},getY:function(d){var c=d.css("transform");if(!c){c=d.css("-webkit-transform")}if(c=="none"){c=0}else{c=c.replace("translateY(","").replace(")","");c=parseFloat(c,10)}if(!c){c=0}return c}});a.clazz=b});M.define("searchland",function(a){var b=function(c){this.init(c)};M.object.merge(b.prototype,{init:function(f){this.searchHistoryLocalStorageName="searchhistory";this.formId=f.formId?f.formId:"";this.submitId=f.submitId?f.submitId:"";this.catelogyListId=f.catelogyListId?f.catelogyListId:"";this.isHome=f.isHome?f.isHome:false;this.renderId=f.renderId?f.renderId:"";this.closeSearchLandBtnId=f.closeSearchLandBtnId?f.closeSearchLandBtnId:"";this.claerKeywordBtnId=f.claerKeywordBtnId?f.claerKeywordBtnId:"";this.keywordId=f.keywordId?f.keywordId:"";this.searchPanelId=f.searchPanelId?f.searchPanelId:"";this.keyword=f.keyword?f.keyword:"";this.keywordIsObj=false;if(M.object.isObject(this.keyword)){this.keywordIsObj=true}else{this.keyword=M.string.decodeHtml(this.keyword)}this.oldkeyword=null;var c="searchhistory_";this.controlId=M.genId(c);this.hotKeyWordId=M.genId(c);this.changeHotKeyWordId=M.genId(c);this.hotKeyWordheadId=M.genId(c);this.searchhistoryTipId=M.genId(c);this.hotKeyWordBtnIds=[];this.clearHistoryId=M.genId(c);this.hotKeyword=f.hotKeyword?f.hotKeyword:null;this.landSearchWordHide=f.landSearchWordHide?true:false;this.hotKeywordIndex=0;this.openSearchLoad=false;this.searchliIdList=[];this.searchLoop=false;this.showFuncObj=f.showFuncObj?f.showFuncObj:null;this.hideFuncObj=f.hideFuncObj?f.hideFuncObj:null;if(this.keyword){var e=this.keyword;if(this.keywordIsObj){e=this.keyword.showWord?this.keyword.showWord:"";if(this.keyword.keyword){if(this.keyword.keyword!=this.keyword.realWord){var d=M.string.decodeHtml(this.keyword.keyword);$("#"+this.keywordId).val(d)}else{$("#"+this.keywordId).val("")}}$("#"+this.keywordId).attr("placeholder",e)}else{$("#"+this.keywordId).val(e);$("#"+this.keywordId).attr("placeholder","")}$("#"+this.keywordId).addClass("hilight1")}},searchLoadControl:function(){var d=this;var c=$("#"+d.keywordId).val().trim();if(c==""&&d.searchLoop){d.searchLoadFromHistory();$("#"+d.claerKeywordBtnId).css({display:"none"})}else{if(c!=""&&d.oldkeyword!=c&&d.searchLoop){d.searchLoadFromKeyword(c);$("#"+d.claerKeywordBtnId).css({display:"block"})}}setTimeout(function(){d.searchLoadControl()},500)},searchLoadFromHistory:function(){var f=this;f.searchLoop=false;if(!f.searchLocalStorage){var c=M.localstorage.get(f.searchHistoryLocalStorageName);try{c=JSON.parse(c)}catch(g){c=null;M.localstorage.remove(f.searchHistoryLocalStorageName)}if(c!=null&&!M.object.isArray(c)){c=null;M.localstorage.remove(f.searchHistoryLocalStorageName)}if(c&&c.length>0&&f.openSearchLoad){var d=c;f.searchLandUnbind();$("#"+f.controlId).html("<strong>历史</strong>"+f.searchLandLiHtml(d,true));$("#"+f.clearHistoryId).parent().css({display:"block;"});f.searchLandBind(true);f.tipArray=d;$("#"+f.controlId).removeClass("jd-auto-complete");$("#"+f.controlId).children("li").css({display:"block"});f.searchLoop=true}else{$("#"+f.controlId).html("");f.searchLoop=true}$("#"+f.hotKeyWordId).show();$("#"+f.hotKeyWordheadId).show()}else{if(f.openSearchLoad){f.searchLoop=true}}f.searchLocalStorage=true},searchLoadFromKeyword:function(c){var d=this;d.searchLoop=false;d.oldkeyword=c;d.searchLocalStorage=false;M.http.ajax({url:"/ware/searchSuggestion.action",data:{keyword:c,_format_:"json"},success:function(f){if(f&&f.searchTipList&&d.openSearchLoad){var e=JSON.parse(f.searchTipList);if(e.length>0){d.searchLandUnbind();$("#"+d.hotKeyWordId).hide();$("#"+d.hotKeyWordheadId).hide();$("#"+d.controlId).html(d.searchLandLiHtml(e));$("#"+d.controlId).addClass("jd-auto-complete");d.searchLandBind(false);d.tipArray=e;$("#"+d.clearHistoryId).parent().css({display:"none;"});$("#"+d.controlId).children("li").css({display:"block"})}d.searchLoop=true}else{if(d.openSearchLoad){d.searchLoop=true}}},error:function(e){if(d.openSearchLoad){d.searchLoop=true}}})},searchLandLiHtml:function(m,d){var c=this;c.searchliIdList=[];var f=[];var k="search-history-li";if(!d){k="search-landing-li"}for(var g=0;g<m.length;g++){var e="searchland_li_"+g;c.searchliIdList.push(e);var l="";var h="&nbsp;";l=m[g].text;f.push('<li searchland_index="'+g+'" id="'+e+'"  style="display: block;" class="'+k+'">');f.push('<a href="javascript:void(0);">');if(!d){var j="search-result-old-icon search-magnifier-icon";if(m[g].otherAttr){if(m[g].otherAttr.isSearchShop){j="search-result-icon search-shop-icon"}}f.push('<i class="'+j+'"></i>')}f.push('<span class="search-landing-entry">'+l+"</span>");if(!d){if(m[g].otherAttr&&m[g].otherAttr.tipNumber){f.push('<span class="search-landing-num">约'+m[g].otherAttr.tipNumber+"条结果</span>")}}f.push("</a>");f.push("</li>")}return f.join("")},searchLandLiFade:function(){var d=this;var c=0;d.searchLandLiRecursiveFade(c,d.searchliIdList.length)},searchLandLiRecursiveFade:function(c,d){var e=this;if(c<d){$("#"+e.searchliIdList[c]).fadeIn(10,function(){var f=c+1;e.searchLandLiRecursiveFade(f,d)})}else{e.searchLoop=true}},searchLandUnbind:function(){var e=this;if(e.searchliIdList&&e.searchliIdList.length>0){for(var d=0,c=e.searchliIdList.length;d<c;d++){$("#"+e.searchliIdList[d]).off("click")}}},searchLandBind:function(c){var f=this;if(f.searchliIdList.length>0){var e=c;for(var d=0;d<f.searchliIdList.length;d++){$("#"+f.searchliIdList[d]).on("click",function(){var g=$(this).attr("searchland_index");var h=f.tipArray[g];f.searchLandSubmit(h,(e?"MSearch_HistoryRecords":"MSearch_SearchDropDownAssociationalWords"))})}}},searchLandSubmit:function(c,d){var f=this;var e=null;var g=null;if(M.object.isObject(c)){g=c;e=JSON.parse(g.value)}else{g={};e={};if(f.keywordIsObj&&c==f.keyword.showWord){g.text=f.keyword.showWord;e.keyword=f.keyword.realWord;g.value=JSON.stringify(e);g.text=c}else{e.keyword=c;g.value=JSON.stringify(e);g.text=c}}f.sendMping(d,e.keyword);$("#"+f.keywordId).val(e.keyword);e.catelogyList&&$("#"+f.catelogyListId).val(JSON.stringify(e.catelogyList));f.searchLandAddHistory(g);if(g.otherAttr&&g.otherAttr.isSearchShop){$("#"+f.formId).attr("action","/shop/searchShop.action")}else{$("#"+f.formId).attr("action","/ware/search.action")}$("#"+f.formId).submit();f.searchLoop=false},searchLandAddHistory:function(k){var h=this;var f=M.localstorage.get(h.searchHistoryLocalStorageName);try{f=JSON.parse(f)}catch(j){f=null;M.localstorage.remove(h.searchHistoryLocalStorageName)}if(!M.object.isArray(f)){f=null;M.localstorage.remove(h.searchHistoryLocalStorageName)}k.text=h.makeSearchName(k.text);delete k.tipNumber;if(f&&f.length>0){var g=0;var c=[k];for(var d=0;d<f.length;d++){if(g==14){break}if(f[d].text!=k.text){c.push(f[d])}g++}f=c}else{f=[];f.push(k)}M.localstorage.set(h.searchHistoryLocalStorageName,JSON.stringify(f))},makeSearchName:function(c){if(c.length>=30){c=c.substring(0,30)}return c},clearHistory:function(){var c=this;M.localstorage.remove(c.searchHistoryLocalStorageName)},searchTransformation:function(){var f=this;if(!f.openSearchLoad){$("body").removeClass("hide-landing");$("body").addClass("show-landing");$("body").addClass("history-color");var c=$("body").children("div");for(var d=0;d<c.length;d++){if($(c[d]).attr("id")!="search_land_searchland"&&!$(c[d]).attr("search_land_searchTransformation_show")){$(c[d]).css("display","none")}}$("body").children("footer").css("display","none");if(f.showFuncObj&&f.showFuncObj.func){var e=f.showFuncObj.source?f.showFuncObj.source:null;f.showFuncObj.func.call(e)}$("#"+f.searchPanelId).removeClass("on-blur");$("#"+f.searchPanelId).addClass("on-focus");window.scrollTo(0,1);f.openSearchLoad=true;f.searchLoop=true}else{$("body").removeClass("show-landing");$("body").removeClass("history-color");$("body").addClass("hide-landing");var c=$("body").children("div");for(var d=0;d<c.length;d++){if($(c[d]).attr("id")!="search_land_searchland"&&!$(c[d]).attr("search_land_searchTransformation_show")){$(c[d]).css("display","block")}}$("body").children("footer").css("display","block");if(f.hideFuncObj&&f.hideFuncObj.func){var e=f.hideFuncObj.source?f.hideFuncObj.source:null;f.hideFuncObj.func.call(e)}f.openSearchLoad=false;f.searchLoop=false;f.searchLocalStorage=false;f.oldkeyword="";$("#"+f.controlId).html("");$("#"+f.searchPanelId).removeClass("on-focus");$("#"+f.searchPanelId).addClass("on-blur");$("#"+f.hotKeyWordId).show();$("#"+f.hotKeyWordheadId).show()}},searchLandHotKeywordRecursiveFade:function(c,g,d,f){var h=this;if(d<f){for(var e=d;e<f;e++){if(e<=2){$(c[e]).addClass("tab-item-1")}else{$(c[e]).addClass("tab-item-2")}}setTimeout(function(){for(var j=d;j<f;j++){if(j<=2){$(c[j]).find("span").text(g[j])}}},310);setTimeout(function(){for(var j=d;j<f;j++){if(j<=2){$(c[j]).removeClass("tab-item-1")}}},500);setTimeout(function(){for(var j=d;j<f;j++){if(j>2){$(c[j]).find("span").text(g[j])}}},410);setTimeout(function(){for(var j=d;j<f;j++){if(j>2){$(c[j]).find("span").text(g[j]);$(c[j]).removeClass("tab-item-2")}}},750)}},mainHtml:function(){var e=this;var d=[];d.push('<div id="search_land_searchland" class="search-lading-area">');if(e.hotKeyword&&e.hotKeyword.length>0){d.push('<div style="transform-origin: 0px 0px 0px; opacity: 1; transform: scale(1, 1);" class="hot-search-new-bar" id="'+e.hotKeyWordheadId+'">');d.push("<strong>热搜</strong>");d.push('<span class="search_replace" id="'+e.changeHotKeyWordId+'"></span>');d.push('<div style="transform-origin: 0px 0px 0px; opacity: 1; transform: scale(1, 1);" class="search-landing-tags" id="'+e.hotKeyWordId+'">');for(var c=0;c<6&&c<e.hotKeyword.length;c++){e.hotKeywordIndex=c;var f="hotKeyWordBtn_"+c;e.hotKeyWordBtnIds.push(f);d.push('<a href="javascript:void(0);" id="'+f+'"><span>'+e.hotKeyword[c]+"</span></a>")}d.push("</div>");d.push("</div>")}d.push('<ul id="'+e.controlId+'" class="search-landing-keywords">');d.push("</ul>");d.push('<div style="display: block;" class="search-landing-clear"><span id="'+e.clearHistoryId+'">清空历史搜索</span></div>');d.push("</div>");return d.join("")},sendMping:function(f,c){try{var g=new MPing.inputs.Click(f);g.event_param=c?c:"";var d=new MPing();d.send(g)}catch(h){}},render:function(){var d=this;if(M.object.isObject(d.renderId)||M.object.isArray(d.renderId)){$(d.renderId).append(d.mainHtml())}else{$("#"+d.renderId).append(d.mainHtml())}$("body").addClass((d.isHome?"mhome":"mlist"));$("body").addClass("hide-landing");$("#"+d.keywordId).on("click",function(h){var f=null;if(d.isHome){if(d.openSearchLoad){f="MSearch_Search"}else{f="MHome_Search"}}else{f="MProductList_Search"}d.sendMping(f);if(!d.openSearchLoad){if(d.landSearchWordHide){$("#"+d.keywordId).val("")}else{var i=d.keyword;if(d.keywordIsObj){i=d.keyword.showWord?d.keyword.showWord:"";if(d.keyword.keyword){if(d.keyword.keyword!=d.keyword.realWord){var g=M.string.decodeHtml(d.keyword.keyword);$("#"+d.keywordId).val(g)}else{$("#"+d.keywordId).val("")}}$("#"+d.keywordId).attr("placeholder",i)}else{$("#"+d.keywordId).val(i)}}d.searchTransformation()}});$("#"+d.keywordId).on("keydown",function(g){if(g.keyCode=="13"){var f=$.trim($("#"+d.keywordId).val());var h=$.trim($("#"+d.keywordId).attr("placeholder"));if(f==""&&h!=""){f=h}if(f!=""){d.searchLandSubmit(f,"MSearch_Searchthi")}}return});$("#"+d.closeSearchLandBtnId).on("click",function(){if(d.openSearchLoad){d.searchTransformation();var f=d.keyword;if(d.keywordIsObj){f=d.keyword.showWord?d.keyword.showWord:"";if(d.keyword.keyword){if(d.keyword.keyword!=d.keyword.realWord){var e=M.string.decodeHtml(d.keyword.keyword);$("#"+d.keywordId).val(e)}else{$("#"+d.keywordId).val("")}}else{$("#"+d.keywordId).val("")}$("#"+d.keywordId).attr("placeholder",f)}else{$("#"+d.keywordId).val(f)}$("#"+d.keywordId).addClass("hilight1")}});$("#"+d.clearHistoryId).on("click",function(){if(confirm("确定要清空吗?")){d.sendMping("MSearch_ClearHistory");d.clearHistory();$("#"+d.controlId).html("");$("#"+d.clearHistoryId).parent().css({display:"none;"})}});$("#"+d.submitId).on("click",function(){var f=$.trim($("#"+d.keywordId).val());var g=$.trim($("#"+d.keywordId).attr("placeholder"));if(f==""&&g!=""){f=g}if(f!=""){var e=null;if(d.isHome){if(d.openSearchLoad){e="MSearch_SearchButton"}else{e="MHome_SearchButton"}}else{e="MSearch_SearchButton"}d.searchLandSubmit(f,e)}});$("#"+d.claerKeywordBtnId).on("click",function(){$("#"+d.keywordId).val("");$(this).css({display:"none;"})});$("#"+d.keywordId).on("keyup",function(){if($(this).val()!=d.keyword){$(this).removeClass("hilight1");$(this).addClass("hilight2")}else{$(this).removeClass("hilight2");$(this).addClass("hilight1")}});if(d.hotKeyWordBtnIds.length>0){for(var c=0;c<d.hotKeyWordBtnIds.length;c++){$("#"+d.hotKeyWordBtnIds[c]).on("click",function(){var e=$.trim($(this).find("span").text());if(e!=""){d.searchLandSubmit(e,"MSearch_HotWords")}})}}if(d.hotKeyword&&d.hotKeyword.length>0){$("#"+d.changeHotKeyWordId).on("click",function(){var f=0;var h=[];for(var g=d.hotKeywordIndex+1,e=g+6;g<e&&g<d.hotKeyword.length;g++){f++;d.hotKeywordIndex=g;h.push(d.hotKeyword[g])}if(f<6){for(var g=0,e=6-f;g<e&&g<d.hotKeyword.length;g++){f++;d.hotKeywordIndex=g;h.push(d.hotKeyword[g])}}var k=$("#"+d.hotKeyWordId).find("a");$("#"+d.changeHotKeyWordId).addClass("rotate");setTimeout(function(){$("#"+d.changeHotKeyWordId).removeClass("rotate")},500);d.sendMping("MSearch_ChangeKeyWords");d.searchLandHotKeywordRecursiveFade(k,h,0,f)})}d.searchLoadControl()}});a.clazz=b});M.define("search",function(a){var b=function(c){this.init(c)};M.object.merge(b.prototype,{init:function(g){g.searchitempanel.checkFuncObj={};g.searchitempanel.checkFuncObj.func=this.reload;g.searchitempanel.checkFuncObj.source=this;if(g.searchlist&&g.searchlist.data&&g.searchlist.data.shopInfo){this.shopInit(g.searchlist.data.shopInfo)}else{$("#shopMain").attr("search_land_searchTransformation_show","true")}this.sort="";this.integrativeOpen=false;this.toReload=false;this.skuId=null;this.promotionId=null;var e=M.localstorage.get("search_item");e=JSON.parse(e);if(!e){e={baseParams:g.searchlist.baseParams,timeStamp:g.searchlist.timeStamp,item:null};M.localstorage.set("search_item",JSON.stringify(e));this.toReload=false}else{var f=e.item;var h=e.baseParams;var d=e.timeStamp;if(h==g.searchlist.baseParams&&d==g.searchlist.timeStamp){if(f){this.toReload=true;g.searchitempanel.checkItem=f;this.sort=f.sort;this.promotionId=f.promotionID}else{e={baseParams:g.searchlist.baseParams,timeStamp:g.searchlist.timeStamp,item:{}};M.localstorage.set("search_item",JSON.stringify(e));this.toReload=false}}else{e={baseParams:g.searchlist.baseParams,timeStamp:g.searchlist.timeStamp,item:{}};M.localstorage.set("search_item",JSON.stringify(e));this.toReload=false}}this.searchItemPanel=new (M.exports("searchitempanel").clazz)(g.searchitempanel);if(g.activityId){g.searchlist.isOrder=true;g.searchlist.orderTitle=g.activityTip;this.skuId=g.skuId}else{var c=g.searchland;if(g.searchBoxWord){c.keyword=g.searchBoxWord;c.keyword.keyword=g.keyword}else{c.keyword=g.keyword}this.searchLand=new (M.exports("searchland").clazz)({showFuncObj:{source:this,func:function(){var i=this;i.searchList.closeLoad();$("#layout_jdBar").hide();$("#layout_urlblack").hide();$("#layout_clear_keyword").show();$("#layout_search_submit").show()}},hideFuncObj:{source:this,func:function(){var i=this;i.searchList.opendLoad();$("#layout_urlblack").show();$("#layout_clear_keyword").hide();$("#layout_search_submit").hide()}},claerKeywordBtnId:"layout_clear_keyword",renderId:$("body"),keyword:c.keyword?c.keyword:"",hotKeyword:c.hotKeyword?c.hotKeyword:null,submitId:"layout_search_submit",formId:"layout_searchForm",catelogyListId:"layout_category",keywordId:"layout_newkeyword",isHome:false,closeSearchLandBtnId:"layout_search_bar_cancel",searchPanelId:"layout_search_head"})}g.searchlist.listUrl="/ware/searchList.action";g.searchlist.buriedPointVal="search";g.searchlist.keyword=g.keyword?g.keyword:"";this.searchList=new (M.exports("searchlist").clazz)(g.searchlist)},closeMask:function(){var c=this;$("#integrative-menu").removeClass("show");$("#integrative-menu").hide();$("#integrative-mask").css({height:"0px;","margin-top":"0px;"});$("#list").attr("style","");$("body").attr("style","");c.integrativeOpen=false;c.searchList.opendLoad()},openMask:function(){var d=this;$("#integrative-menu").addClass("show");$("#integrative-menu").show();$("#integrative-menu").css({"z-index":5});$("#integrative-mask").css({height:$(window).height()+"px","margin-top":"108px"});var c=$("header").height();c=c+$("footer").height();$("#list").attr("style","height:"+($(window).height()-c)+"px;overflow: hidden;");$("body").attr("style","height: "+$(window).height()+"px;overflow: hidden;");d.integrativeOpen=true;d.searchList.closeLoad()},integrativeMenu:function(e,g,f,c){var d=this;$("#integrative-menu").children().removeClass("active");e&&$(e).addClass("active")&$("#sales-volume-order").removeClass("active")&$("#prcie-order").removeClass("active")&$("#prcie-order").children().removeClass("arrow-down")&$("#prcie-order").children().removeClass("arrow-up")&$("#search_promotion").removeClass("active")&$("#integrative").addClass("active");g&&$("#integrative").find("a").text(g);d.closeMask();if(d.sort!=f||c){d.sort=f;d.reload(true)}},bind:function(){var e=this;$("#screening").on("click",function(){e.searchItemPanel.keepBefore();e.searchItemPanel.show();$("#integrative-menu").removeClass("show");$("#integrative-menu").hide();$("#integrative-mask").css({height:"0px;","margin-top":"0px;"});e.integrativeOpen=false;e.searchList.opendLoad()});$("#integrative-mask").on("click",function(){e.closeMask()});$("#sales-volume-order").on("click",function(){if(e.searchList.isReloadHasData()){e.promotionId=null;if(!$(this).hasClass("active")){$(this).addClass("active");$("#integrative").removeClass("active");$("#prcie-order").removeClass("active");$("#search_promotion").removeClass("active");$("#prcie-order").children().removeClass("arrow-down");$("#prcie-order").children().removeClass("arrow-up");e.integrativeMenu(null,null,"1")}}});$("#prcie-order").on("click",function(){if(e.searchList.isReloadHasData()){e.promotionId=null;if(!$(this).children().hasClass("arrow-down")){$(this).addClass("active");$(this).children().addClass("arrow-down");$(this).children().removeClass("arrow-up");e.integrativeMenu(null,null,"3")}else{$(this).addClass("active");$(this).children().addClass("arrow-up");$(this).children().removeClass("arrow-down");e.integrativeMenu(null,null,"2")}$("#integrative").removeClass("active");$("#sales-volume-order").removeClass("active");$("#search_promotion").removeClass("active")}});$("#search_promotion").on("click",function(){if(e.searchList.isReloadHasData()){if(!$(this).hasClass("active")){$(this).addClass("active");var f=$(this).attr("promotionId");$("#integrative").removeClass("active");$("#prcie-order").removeClass("active");$("#sales-volume-order").removeClass("active");$("#prcie-order").children().removeClass("arrow-down");$("#prcie-order").children().removeClass("arrow-up");e.promotionId=f;e.integrativeMenu(null,null,"",true)}}});$("#integrative").on("click",function(){if(e.searchList.isReloadHasData()){if(e.integrativeOpen){e.closeMask()}else{e.openMask()}}});$("#comprehensive-order").on("click",function(){if(e.searchList.isReloadHasData()){e.promotionId=null;e.integrativeMenu(this,"综合","",true)}});$("#new-product-order").on("click",function(){if(e.searchList.isReloadHasData()){e.promotionId=null;e.integrativeMenu(this,"新品","5")}});$("#comment-order").on("click",function(){if(e.searchList.isReloadHasData()){e.promotionId=null;e.integrativeMenu(this,"评价","6")}});var d="onorientationchange" in window;var c=d?"orientationchange":"resize";$(window).on(c,function(){e.searchItemPanel.redioWidth()})},clearOrder:function(){var c=this;$("#integrative-menu").children().removeClass("active");$("#sales-volume-order").removeClass("active");$("#prcie-order").removeClass("active");$("#search_promotion").removeClass("active");$("#prcie-order").children().removeClass("arrow-down");$("#prcie-order").children().removeClass("arrow-up");$("#integrative").addClass("active");$("#integrative").find("a").text("综合");c.sort="";c.promotionId=null},reload:function(f){var e=this;var c=e.searchItemPanel.getValue();c=c?c:{};var g=e.searchItemPanel.getItemValue();if(!f){e.clearOrder()}if(e.skuId){c.skuId=e.skuId}if(e.sort){c.sort=e.sort}if(e.promotionId){c.promotionID=e.promotionId}var d=M.localstorage.get("search_item");if(d){d=JSON.parse(d);d.item={};for(key in c){d.item[key]=c[key]}d.item.itemValue=g;M.localstorage.set("search_item",JSON.stringify(d))}e.searchList.reload(c)},shopInit:function(c){$("#shopUrl").attr("href","http://ok.jd.com/m/index-"+c.shopId+".htm");$("#shopUrl").attr("report-eventparam",c.shopId);$("#shopName").text(c.shopName);$("#shopLogo").attr("src",c.logoUrl);$("#shopScore").css("width",(c.score*10)+"%");$("#shopMain").show()},render:function(){var d=this;d.searchItemPanel&&d.searchItemPanel.render();d.searchList&&d.searchList.render();d.searchLand&&d.searchLand.render();d.bind();if(d.toReload){var c={"6":"评价","5":"新品"};if(d.sort=="5"||d.sort=="6"){var e={"6":"#comment-order","5":"#new-product-order"};d.integrativeMenu($(e[d.sort]),c[d.sort],d.sort,true)}else{if(d.sort=="1"){if(!$("#sales-volume-order").hasClass("active")){$("#sales-volume-order").addClass("active");$("#integrative").removeClass("active");$("#prcie-order").removeClass("active");$("#prcie-order").children().removeClass("arrow-down");$("#prcie-order").children().removeClass("arrow-up");d.integrativeMenu(null,null,"1",true)}}else{if(d.sort=="2"||d.sort=="3"){if(d.sort=="3"){$("#prcie-order").addClass("active");$("#prcie-order").children().addClass("arrow-down");$("#prcie-order").children().removeClass("arrow-up");d.integrativeMenu(null,null,"3",true)}else{$("#prcie-order").addClass("active");$("#prcie-order").children().addClass("arrow-up");$("#prcie-order").children().removeClass("arrow-down");d.integrativeMenu(null,null,"2",true)}$("#integrative").removeClass("active");$("#sales-volume-order").removeClass("active");$("#search_promotion").removeClass("active")}else{if(d.promotionId){$("#search_promotion").addClass("active");$("#integrative").removeClass("active");$("#sales-volume-order").removeClass("active");$("#prcie-order").removeClass("active");$("#prcie-order").children().removeClass("arrow-down");$("#prcie-order").children().removeClass("arrow-up");d.integrativeMenu(null,null,"",true)}else{d.reload()}}}}}},run:function(){var c=this;c.render()}});a.clazz=b});M.define("searchitembutton",function(b){var a=function(c){this.init(c)};M.object.merge(a.prototype,{init:function(d){this.value=null;this.baseId="";this.secondChange=d.secondChange?d.secondChange:false;this.beforeSecondChange=false;if(d.value){this.value=d.value}this.text=d.text?d.text:"";this.baseId=d.id?d.id:null;this.id=d.id?M.genId("m_searchItembutton_"+d.id):M.genId("m_searchItembutton_");var c=[];M.object.each(d.otherAttr,function(f,e){c.push(f)});this.othersText=c.join(",")},getType:function(){return"searchitembutton"},keepBefore:function(){var c=this;c.beforeSecondChange=c.secondChange},reBefore:function(){var c=this;if(c.secondChange!=c.beforeSecondChange){c.secondChange=c.beforeSecondChange;if(c.secondChange){$("#"+c.id).addClass("checked")}else{$("#"+c.id).removeClass("checked")}}},getText:function(){var c=this;if(c.secondChange){return c.text}else{return null}},getValue:function(){var c=this;if(c.secondChange){return c.value}else{return null}},getBaseId:function(){var c=this;return c.baseId},getId:function(){var c=this;return c.id},isCheck:function(){var c=this;return c.secondChange},cancel:function(c){var d=this;d.secondChange=false;if(c){$("#"+d.id).removeClass("checked")}},bind:function(g,f,d){var h=this;$("#"+h.id).on("click",function(){if(!h.secondChange){h.secondChange=true;$(this).addClass("checked")}else{$(this).removeClass("checked");h.secondChange=false}if(g&&M.object.isFunction(g)){var i=[h];if(d){i=[h].concat(d)}var j=f?f:null;g.apply(j,i)}});if(h.isCheck()){if(g&&M.object.isFunction(g)){var c=[h];if(d){c=[h].concat(d)}var e=f?f:null;g.apply(e,c)}}},html:function(){var d=this;var c='<li id="'+d.id+'" class="'+(d.secondChange?"checked":"")+'"><i class="tick"></i><span>'+d.text+"</span>"+(d.othersText&&d.othersText!=""?("<small>"+d.othersText+"</small>"):"")+"</li>";return c}});b.clazz=a});M.define("searchiteminput",function(a){var b=function(c){this.init(c)};M.object.merge(b.prototype,{init:function(c){this.value=null;this.baseId="";this.secondChange=false;this.beforeSecondChange=false;this.baseId=c.id?c.id:null;this.id=c.id?M.genId("m_searchiteminput_"+c.id):M.genId("m_searchiteminput_");this.firstText=c.firstText?c.firstText:"";this.secondText=c.secondText?c.secondText:"";this.firstValue=c.firstValue?c.firstValue:"";this.secondValue=c.secondValue?c.secondValue:"";this.firstName=c.firstName?c.firstName:M.genId("m_searchiteminput_");this.secondName=c.secondName?c.secondName:M.genId("m_searchiteminput_");this.firstId=c.firstId?c.firstId:M.genId("m_searchiteminput_");this.secondId=c.secondId?c.secondId:M.genId("m_searchiteminput_");this.isNum=c.isNum?c.isNum:true;this.checkId=M.genId("m_searchiteminput_");this.checkBtnFunc=c.checkBtnFunc?c.checkBtnFunc:null;this.textCallFunc=c.textCallFunc?c.textCallFunc:"";this.check=false;this.beforeCheck=false;this.beforefirstVal="";this.beforeSecondVal=""},getType:function(){return"searchiteminput"},keepBefore:function(){var c=this;try{c.beforefirstVal=$.trim($("#"+c.firstId).val());c.beforeSecondVal=$.trim($("#"+c.secondId).val())}catch(d){}},reBefore:function(){var c=this;$("#"+c.firstId).val(c.beforefirstVal);$("#"+c.secondId).val(c.beforeSecondVal)},getText:function(){var c=this;return c.textCallFunc.call(c)},getValue:function(){var c=this;return c.value},getBaseId:function(){var c=this;return c.baseId},getId:function(){var c=this;return c.id},cancel:function(){var c=this;$("#"+c.firstId).val("");$("#"+c.secondId).val("");c.value=null},bind:function(g,f,d){var h=this;$("#"+h.checkId).on("click",function(){if(h.checkBtnFunc&&M.object.isFunction(h.checkBtnFunc)){if(h.checkBtnFunc.call(h)){h.value='{"'+h.firstName+'" : "'+$.trim($("#"+h.firstId).val())+'", "'+h.secondName+'" : "'+$.trim($("#"+h.secondId).val())+'"}'}else{h.value=null}}else{if($.trim($("#"+h.firstId).val())&&$.trim($("#"+h.secondId).val())){h.value='{"'+h.firstName+'" : "'+$.trim($("#"+h.firstId).val())+'", "'+h.secondName+'" : "'+$.trim($("#"+h.secondId).val())+'"}'}else{h.value=null}}if(g&&M.object.isFunction(g)){var i=[h];if(d){i=[h].concat(d)}var j=f?f:null;g.apply(j,i)}});if($.trim($("#"+h.firstId).val())&&$.trim($("#"+h.secondId).val())){h.value='{"'+h.firstName+'" : "'+$.trim($("#"+h.firstId).val())+'", "'+h.secondName+'" : "'+$.trim($("#"+h.secondId).val())+'"}'}if(h.value&&g&&M.object.isFunction(g)){var c=[h];if(d){c=[h].concat(d)}var e=f?f:null;g.apply(e,c)}},html:function(){var d=this;var c=[];c.push('<li id="'+d.id+'" class="">');c.push('<table class="price-range">');c.push("<tr>");c.push('<td><input class="adv-srch-num-inpt" value="'+d.firstValue+'" id="'+d.firstId+'" maxlength="10" '+(d.firstText?'placeholder="'+d.firstText+'"':"")+" "+(d.isNum?'type="number" pattern="[0-9]*"':"")+"></td>");c.push('<td><em class="dash"></em></td>');c.push('<td><input class="adv-srch-num-inpt"  value="'+d.secondValue+'"  id="'+d.secondId+'" maxlength="10" '+(d.secondText?'placeholder="'+d.secondText+'"':"")+" "+(d.isNum?'type="number" pattern="[0-9]*"':"")+"></td>");c.push('<td><button id="'+d.checkId+'" class="confirm">确定</button></td>');c.push("</tr>");c.push("</table>");c.push("</li>");return c.join("")}});a.clazz=b});M.define("searchitempanel",function(a){var b=function(c){this.init(c)};M.object.merge(b.prototype,{init:function(c){this.baseId=c.id?M.genId("m_searchutempanel_"+c.id):M.genId("m_searchutempanel_");this.id=c.id?M.genId("m_searchutempanel_"+c.id):M.genId("m_searchutempanel_");this.baseLiId=this.id+"_li";this.itemGroupId=M.genId(this.baseId+"_item");this.rediosId=M.genId(this.baseId+"_redio");this.reCheckId=M.genId(this.baseId+"_reCheckId");this.checkId=M.genId(this.baseId+"_checkId");this.cancelCheckId=M.genId(this.baseId+"_cancelCheckId");this.sidebarid=M.genId(this.baseId+"_sidebar");this.shadowId=M.genId(this.baseId+"_shadowid");this.itemNameGroupId=M.genId(this.baseId+"_itemNameGroupid");this.menuId=M.genId(this.baseId+"_menuid");this.sidebarHeaderTitleId=M.genId(this.baseId+"sidebarHeaderTitleId");this.areaBaesKey="m_saerch_area_";this.regionTextLocalstorageKey="m_saerch_area_regionText";this.areaRegionId=M.genId(this.areaBaesKey+"_areaRegionId");this.regionTextId=M.genId(this.areaBaesKey+"_regionTextId");this.priceMinId=M.genId(this.baseId+"price");this.priceMaxId=M.genId(this.baseId+"price");this.checkfuncObj=c.checkFuncObj;this.others=[];this.renderId=c.renderId;this.searchRadioArray=[];this.searchItem=[];this.categories=[];this.region=[];this.tempRegion=[];this.regionIndexObj={getProvinces:0,getCitys:1,getCountys:2,getTowns:3};this.beforeRegion=[];this.regionTextArr=[];this.beforeRegionText="";this.regionText="";this.itemValue=c.checkItem&&c.checkItem.itemValue?c.checkItem.itemValue:{};this.beforIitemValue={};this.thisIitemValue={};this.itemAttrArr=[];this.itemDeep=0;c.searchItem&&this.createSearchItemBtnGroupList(c.searchItem);c.searchRadio&&this.createSearchRadioArrayGroupList(c.searchRadio,c.checkItem);if(c.checkItem.region){this.region=c.checkItem.region;this.regionText=M.localstorage.get(this.regionTextLocalstorageKey)}},createSearchItemBtnGroupList:function(e){var f=this;var c=[];if(e&&M.object.isArray(e)&&e.length>0){for(var d=0;d<e.length;d++){if(e[d].itemArray&&e[d].itemArray.length>0&&e[d].itemArray[0].termList&&e[d].itemArray[0].termList.length>0){if(e[d].key=="catelogyList"){f.categories.push(e[d])}else{f.searchItem.push(e[d])}}}}},createSearchRadioArrayGroupList:function(d,c){var f=this;if(d&&M.object.isArray(d)&&d.length>0){for(var e=0;e<d.length;e++){if(c[d[e].key]){d[e].isCheck=true}var g=new (M.exports("searchradio").clazz)(d[e]);f.searchRadioArray.push(g)}}},mainItemHtml:function(){var e=this;var d=[];d.push('<div id="'+e.id+'" class="menu_sidebar" id="search-conditions">');d.push('<div id="'+e.shadowId+'" class="list_content_mask" style="display: none;"></div>');d.push('<div id="'+e.menuId+'" class="sidebar-content" style="-webkit-transform-origin: 0px 0px; opacity: 1; -webkit-transform: scale(1, 1);display: none;">');d.push('<div class="sidebar-header">');d.push('<div class="sidebar-header-left arrow-left">');d.push('<span id="'+e.cancelCheckId+'"></span>');d.push("</div>");d.push('<div class="sidebar-header-center">');d.push('<span id="'+e.sidebarHeaderTitleId+'">筛选</span>');d.push("</div>");d.push('<div class="sidebar-header-right J_ping" report-eventparam="" report-eventid="MFilter_Confirm" id="'+e.checkId+'"><span>确定</span></div>');d.push("</div>");d.push('<div id="'+e.sidebarid+'" class="sidebar-items-container">');d.push('<div class="spacer44"></div>');d.push('<div id="'+e.areaRegionId+'" class="sidebar-delivery-info J_ping" report-eventparam="" report-eventid="MFilter_Sendto">');d.push('<div class="sidebar-delivery-address"><i class="arrow"></i><small class="current-region" style="color: rgb(132, 134, 137);" id="'+e.regionTextId+'">不限</small></div>');d.push('<div class="sidebar-delivery-to">配送至</div>');d.push("</div>");d.push('<div class="diver20"></div>');if(e.searchRadioArray.length>0){d.push('<ul id="'+e.rediosId+'" class="sidebar-list sidebar-conditions condition-unit-box">');for(var c=0;c<e.searchRadioArray.length;c++){d.push(e.searchRadioArray[c].html())}d.push("</ul>")}d.push('<ul id="'+e.itemGroupId+'" class="sidebar-list sidebar-categories filter-tree-list">');d.push("</ul>");d.push('<div class="sidebar-clear-settings">');d.push('<span report-eventparam="" report-eventid="MFilter_Reset" class="sidebar-btn-reset J_ping" id="'+e.reCheckId+'">清除选项</span>');d.push("</div>");d.push("</div>");d.push("</div>");d.push("</div>");d.push("</div>");return d.join("")},redioWidth:function(){var f=this;var g=$("#"+f.rediosId);var e=g.find("li");var c=10;var h=g.width();var d=parseInt((h-4*c)/3)-10;e.width(d)},createItemHtml:function(J,f,I){var r=this;var o=[];var m=null;var e="";if(!J&&!f&&!I){var o=[];$("#"+r.sidebarHeaderTitleId).text("筛选");if(r.categories.length>0||r.searchItem.length>0){if(r.categories.length>0){o.push('<li m_classfly="" m_type="categories" m_key="" class="J_ping"  report-eventparam="" report-eventid="MFilter_AllCategories"><a href="javascript:void(0);"><i class="arrow"></i><span class="sort-of-brand">全部分类</span><small class="sort-of-brand"></small></a></li>')}if(r.searchItem.length>0){for(var y=0;y<r.searchItem.length;y++){var p=r.getItemText(r.searchItem[y].key,r.searchItem[y].classfly);o.push('<li m_classfly="'+r.searchItem[y].classfly+'" m_type="searchItem" m_key="'+r.searchItem[y].key+'"><a href="javascript:void(0);"><i class="arrow"></i><span class="sort-of-brand">'+r.searchItem[y].classfly+'</span><small class="sort-of-brand">'+p+"</small></a></li>")}}}}else{if(f=="searchItem"){m=r.searchItem;e="searchItem"}else{m=r.categories;e="categories"}if(J==""){$("#"+r.sidebarHeaderTitleId).text("全部分类");for(var y=0;y<m.length;y++){var u=m[y].key?m[y].key:"";var p=r.getItemText(u,m[y].classfly);o.push('<li m_classfly="'+m[y].classfly+'" m_value="" m_type="'+e+'" m_key="'+u+'"><a href="javascript:void(0);"><i class="arrow"></i><span class="sort-of-brand">'+m[y].classfly+'</span><small class="sort-of-brand">'+p+"</small></a></li>")}}else{var d=false;var n=J;var q={};var D=0;var h=r.itemValue[n]?r.itemValue[n]:[];for(var y=0;y<m.length;y++){if(I==m[y].classfly){d=true;m=m[y].itemArray;break}}if(d){$("#"+r.sidebarHeaderTitleId).text(I);for(var y=0;y<m.length;y++){if(m[y].itemName&&!q[m[y].itemName]){q[m[y].itemName]=true;D++}}o.push('<li m_unchick="1"><div class="brand-sorting-detail" style="">');o.push('<ul id="'+r.itemNameGroupId+'" style="display: none;">');if(D>0){o.push('<li m_unchick="1" class="brand-tab">');var H=0;for(name in q){var C="";var G="";if(name=="按品牌排序"){G="J_ping";C="MFilter_RecommentBrand"}else{if(name=="按字母排序"){G="J_ping";C="MFilter_SortByAlphabet"}}o.push('<span m_index="'+H+'"  report-eventparam="" report-eventid="'+C+'"  class="'+G+'" data-ul=""><label class="'+(H==0?"current brand-seled":"")+'">'+name+"</label></span>");if((D-1)!=H){o.push('<em class="divide-line"></em>')}H++}o.push("</li>")}o.push("</ul>");var z=null;var l=-1;for(var y=0;y<m.length;y++){if(z!=m[y].itemName){z=m[y].itemName;l++;if(y!=0){o.push("</ul>")}o.push('<ul class="tab-con brand" style="'+(y==0?"display: block;":"")+'">')}var w=m[y].termList;var F="";var E=false;for(var v=0;v<w.length;v++){var c="";if(F!=w[v].sign){F=w[v].sign;o.push('<li m_unchick="1" class="letter"><span>'+F+"</span></li>")}var t=w[v].value.replace(/\"/g,"'");if(h.length>0){for(var B=0;B<h.length;B++){if(h[B].classfly==I&&h[B].text==w[v].text&&h[B].index&&h[B].index==y+""){c="checked";E=true;break}}}if(c){c="J_ping "+c}else{c="J_ping"}o.push('<li m_index="'+l+'" m_classfly="'+I+'" m_value="'+t+'" m_type="'+e+'" m_key="'+n+'" class="'+c+'"  report-eventparam="'+w[v].text+'" report-eventid="MFilter_Filters" ><i class="tick"></i><span>'+w[v].text+"</span></li>")}if(n=="price"){var s="";var x="";if(!E){if(h.length>0){var A=h[0].value.replace(/\'/g,'"');A=$.parseJSON(A);s=A.min;x=A.max}}o.push('<li m_unchick="1" class="price-range"><i class="tick"></i><span><input id="'+r.priceMinId+'" type="number" value="'+s+'" pattern="[0-9]*" placeholder="起始价格"><i>-</i><input  id="'+r.priceMaxId+'" value="'+x+'" type="number" pattern="[0-9]*" placeholder="终止价格"></span></li>')}if(y==m.length-1){o.push("</ul")}}o.push("</div></li>")}}}return o.join("")},getItemText:function(e,f){var g=this;var i="不限";if(e&&f&&g.itemValue[e]){var d=[];var h=g.itemValue[e];for(var c=0;c<h.length;c++){if(f==h[c].classfly){d.push(h[c].text)}}i=d.join(",");if(i==""){i="不限"}}return i},itemEvent:function(c,t,s){var h=$(t).attr("m_unchick")||"";var k=$(t).attr("m_key")||"";var q=$(t).attr("m_type")||"";var d=$(t).attr("m_value")||"";var m=$(t).attr("m_classfly")||"";var p=$(t).attr("m_index")||"";if(!h){if(k&&q&&d&&m&&p){if($(t).hasClass("checked")){$(t).removeClass("checked");if(c.itemValue[k]){for(var j=0;j<c.itemValue[k].length;j++){if(c.itemValue[k][j].value==d){c.itemValue[k].splice(j,1)}}}}else{if(!c.itemValue[k]){c.itemValue[k]=[]}if(k=="expressionKey"){if(c.itemValue[k].length>0){if(c.itemValue[k][0].index!=p){var f=c.itemValue[k][0].index;c.itemValue[k]=[];$(t).parent().parent().find(".tab-con").eq(f).find("li").removeClass("checked")}}}if(c.itemValue[k].length>0){var f=c.itemValue[k][0].index;if($(t).parent().parent().find(".tab-con").eq(f).find(".checked").size()>=5){var l=$("#alert").find("span");$(l).eq(0).attr("class","car-span-err");$(l).eq(1).text("最多选择5个哦~");$("#alert").fadeIn(200,function(){setTimeout(function(){$("#alert").fadeOut(200)},1000)});return}}if(k=="price"){$("#"+c.priceMinId).val("");$("#"+c.priceMaxId).val("");$(t).parent().parent().find(".tab-con").find("li").removeClass("checked");var r=$.trim($(t).find("span").eq(0).text());c.itemValue[k]=[{value:d,index:p,text:r,classfly:m}]}else{if(k=="expandName"||k=="expandSorts"){var r=$.trim($(t).find("span").eq(0).text());var o={value:d,index:p,text:r,classfly:m};var g=c.itemValue[k];var n=false;for(var e=0;e<g.length;e++){if(m==g[e].classfly){g[e]=o;n=true;break}}if(!n){g.push(o)}else{$(t).parent().parent().find(".tab-con").find("li").removeClass("checked")}}else{var r=$.trim($(t).find("span").eq(0).text());c.itemValue[k].push({value:d,index:p,text:r,classfly:m})}}$(t).addClass("checked")}}else{$("#"+c.itemGroupId).html(c.createItemHtml(k,q,m));if(!k&&!q&&!m){$("#"+c.sidebarid).children().css("display","block");$("#"+c.itemGroupId).css({display:"block","border-top":"","margin-top":""})}else{$("#"+c.sidebarid).children().css("display","none");if($("#"+c.itemNameGroupId).find("label ").size()==0){$("#"+c.itemGroupId).css({display:"block","border-top":"0 none;","margin-top":"44px"})}else{$("#"+c.itemGroupId).css({display:" block"," border-top":"0px none;","margin-top":"0px"})}}if($("#"+c.itemNameGroupId).children().size()>0){$("#"+c.itemNameGroupId).css("display","block");$("#"+c.itemNameGroupId).children().find("span").on("click",function(){var u=$(this).attr("m_index");$(this).parent().find("span").find("label").removeClass("current brand-seled");$(this).find("label").addClass("current brand-seled");var i=$("#"+c.itemNameGroupId).parent().find(".tab-con");$(i).css("display","none");$(i).eq(u).css("display","block")});$(".spacer44").css("display","block")}if(!s){c.itemDeep++;c.itemAttrArr[c.itemDeep]={m_key:k,m_type:q,m_value:d,m_classfly:m,m_index:p}}c.itemBind()}}},itemBind:function(){var c=this;$("#"+c.itemGroupId).find("li").on("click",function(){c.itemEvent(c,this,false)})},cancelBInd:function(c){var e=this;if(e.itemDeep==0){e.reBefore();e.hide()}else{var d=null;if(e.itemAttrArr[e.itemDeep]&&e.itemAttrArr[e.itemDeep].m_key){e.itemValue=JSON.parse(JSON.stringify(e.thisIitemValue))}e.itemDeep--;if(e.itemDeep==0){d={m_key:"",m_type:"",m_value:"",m_classfly:"",m_index:""}}else{d=e.itemAttrArr[e.itemDeep]}for(key in d){$(c).attr(key,d[key])}e.itemEvent(e,c,true)}},checkBInd:function(f){var i=this;if(i.itemDeep==0){i.hide();if(i.checkfuncObj&&i.checkfuncObj.func&&M.object.isFunction(i.checkfuncObj.func)){var g=i.checkfuncObj.source?i.checkfuncObj.source:null;M.localstorage.set(i.regionTextLocalstorageKey,i.regionText);i.checkfuncObj.func.call(g)}}else{i.itemDeep--;var h=null;if(i.itemDeep==0){if(i.itemAttrArr[1]&&i.itemAttrArr[1].m_key=="price"){var e=$("#"+i.priceMinId).val();var c=$("#"+i.priceMaxId).val();if(e&&e&&M.string.isUnsignedNumeric(e)&&M.string.isUnsignedNumeric(c)){var d='{"min":"'+e+'","max":"'+c+'"}';i.itemValue.price=[{value:d,index:0,text:e+"-"+c,classfly:"价格"}]}}h={m_key:"",m_type:"",m_value:"",m_classfly:"",m_index:""}}else{h=i.itemAttrArr[i.itemDeep]}i.thisIitemValue=JSON.parse(JSON.stringify(i.itemValue));for(key in h){$(f).attr(key,h[key])}i.itemEvent(i,f,true)}},bind:function(){var d=this;$("#"+d.shadowId).on("click",function(){d.cancelBInd(this)});$("#"+d.cancelCheckId).on("click",function(){d.cancelBInd(this)});for(var c=0;c<d.searchRadioArray.length;c++){d.searchRadioArray[c].bind()}$("#"+d.checkId).on("click",function(){d.checkBInd(this)});$("#"+d.reCheckId).on("click",function(){d.reAll();valobj={m_key:"",m_type:"",m_value:"",m_classfly:"",m_index:""},null,null;for(key in valobj){$(this).attr(key,valobj[key])}d.itemEvent(d,this,true)})},getAreaData:function(f,g){var e=this;if(f){var c=e.areaBaesKey+f+"_"+g;var d=M.localstorage.get(c);if(d){d=JSON.parse(d);if(d.length>0){e.areaItemRender(f,d)}else{e.regionText=e.regionTextArr.join("");e.regionTextArr=[];$("#"+e.regionTextId).text(e.regionText);$("#"+e.regionTextId).css("color","");$("#regionContentMask").css("display","none");$("#regionSideBar").css("display","none")}}else{e.loadArea(f,g)}}else{e.regionText=e.regionTextArr.join("");e.regionTextArr=[];$("#"+e.regionTextId).text(e.regionText);$("#"+e.regionTextId).css("color","");$("#regionContentMask").css("display","none");$("#regionSideBar").css("display","none")}},loadArea:function(d,e){var c=this;$("#area-loading-mask").css("display","block");M.http.ajax({url:"/ware/getArea.action",data:"_format_=json&action="+d+"&areaId="+e,success:function(f){var h=null;if(f&&f.area){h=$.parseJSON(f.area);if(h){var g=c.areaBaesKey+d+"_"+e;M.localstorage.set(g,f.area);if(h.length>0){c.areaItemRender(d,h)}else{c.regionText=c.regionTextArr.join("");c.regionTextArr=[];$("#"+c.regionTextId).text(c.regionText);$("#"+c.regionTextId).css("color","");$("#regionContentMask").css("display","none");$("#regionSideBar").css("display","none")}}}$("#area-loading-mask").css("display","none")},error:function(){$("#area-loading-mask").css("display","none")}})},areahtml:function(j,h){var g=this;var e=[];var c=g.regionIndexObj[j];for(var d=0;d<h.length;d++){var k=h[d];var f="";if(g.tempRegion.length>=c+1&&g.tempRegion[c]==k.id){f="tick"}e.push('<li areaid="'+k.id+'" action="'+k.action+'" class="checked J_ping" report-eventparam="'+k.name+'" report-eventid="MListFilter_Address"><i class="'+f+'"></i><a name="region1"></a><span>'+k.name+"</span></li>")}e.push('<li style="background: rgb(244, 245, 247) none repeat scroll 0px 0px; border-bottom: rgb(244, 245, 247);border-width:0 0 0 0;"><i class=""></i><a></a><span></span></li>');$("#"+j).html(e.join(""))},areaItembind:function(d){var c=this;$("#"+d).children().on("click",function(){var g=$(this).attr("areaid");var f=$(this).attr("action");var h=$(this).find("span").text();if(f&&h&&g){var i=$(this).parent().attr("id");var e=c.regionIndexObj[i];c.tempRegion[e]=g;c.region.push(g);if(g==0){c.regionTextArr=[];c.regionTextArr.push(h)}else{c.regionTextArr.push(h)}$(this).parent().children().find("i").removeClass("tick");$(this).find("i").addClass("tick");c.getAreaData(f,g)}})},areaItemRender:function(e,d){var c=this;c.areahtml(e,d);c.areaItembind(e);$("#"+e).parent().children().removeClass("cur");$("#"+e).addClass("cur")},areaRender:function(e,d){var c=this;$("#"+c.areaRegionId).on("click",function(){$("#regionContentMask").css("display","block");$("#regionSideBar").css("display","block");c.getAreaData("getProvinces",0)});$("#region-back-arrow").on("click",function(){var g=$("#region-wrapper").children();var f=0;for(var h=0;h<g.length;h++){if($(g[h]).hasClass("cur")){f=h;break}}if(f==0){c.region=[].concat(c.beforeRegion);c.regionText=c.beforeRegionText;$("#regionContentMask").css("display","none");$("#regionSideBar").css("display","none")}else{c.regionTextArr.splice(f-1,1);$(g[f]).removeClass("cur");$(g[f-1]).addClass("cur");c.region.splice(f-1,1)}});$("#regionContentMask").on("click",function(){c.region=[].concat(c.beforeRegion);c.regionText=c.beforeRegionText;c.beforeRegionText?$("#"+c.regionTextId).css("color",""):$("#"+c.regionTextId).css("color","#848689");c.beforeRegionText?$("#"+c.regionTextId).text(c.beforeRegionText):$("#"+c.regionTextId).text("不限");$("#regionContentMask").css("display","none");$("#regionSideBar").css("display","none")});c.regionText?$("#"+c.regionTextId).css("color",""):$("#"+c.regionTextId).css("color","#848689");c.regionText?$("#"+c.regionTextId).text(c.regionText):$("#"+c.regionTextId).text("不限")},show:function(){var c=this;c.itemEvent(c,{},true);$("html").removeClass("sidebar-back");$("html").addClass("sidebar-move");$("#"+c.shadowId).show();$("#"+c.menuId).show();c.redioWidth()},hide:function(){var c=this;$("html").addClass("sidebar-back");setTimeout(function(){$("html").removeClass("sidebar-back");$("html").removeClass("sidebar-move")},300);$("#"+c.shadowId).hide();$("#"+c.menuId).hide()},keepBefore:function(){var e=this;e.beforIitemValue=e.itemValue;e.itemValue=JSON.parse(JSON.stringify(e.itemValue));e.thisIitemValue=JSON.parse(JSON.stringify(e.itemValue));for(var d=0;e.searchRadioArray.length>d;d++){e.searchRadioArray[d].keepBefore()}e.beforeRegion=JSON.parse(JSON.stringify(e.region));e.tempRegion=JSON.parse(JSON.stringify(e.region));e.region=[];var c=[e.regionText];e.beforeRegionText=JSON.parse(JSON.stringify(c))[0]},reBefore:function(){var d=this;d.itemValue=JSON.parse(JSON.stringify(d.beforIitemValue));d.thisIitemValue={};d.beforIitemValue={};for(var c=0;d.searchRadioArray.length>c;c++){d.searchRadioArray[c].reBefore()}d.region=d.beforeRegion;d.regionText=d.beforeRegionText;d.beforeRegion=[];d.beforeRegionText="";d.tempRegion=[];d.regionTextArr=[];d.beforeRegionText?$("#"+d.regionTextId).css("color",""):$("#"+d.regionTextId).css("color","#848689");d.beforeRegionText?$("#"+d.regionTextId).text(d.beforeRegionText):$("#"+d.regionTextId).text("不限")},reAll:function(){var d=this;for(var c=0;d.searchRadioArray.length>c;c++){d.searchRadioArray[c].cancel(true)}d.itemValue={};d.region=[];d.regionTextArr=[];d.regionText="";$("#"+d.regionTextId).css("color","#848689");$("#"+d.regionTextId).text("不限")},getItemValue:function(){var c=this;return c.itemValue},getValue:function(){var e={};var d=this;for(key in d.itemValue){var h=d.itemValue[key];var g=[];for(var c=0;h.length>c;c++){var f=h[c].value;g.push(f)}if(g.length>0){e[key]=g}}for(var c=0;d.searchRadioArray.length>c;c++){if(d.searchRadioArray[c].getValue()){e[d.searchRadioArray[c].getKey()]=d.searchRadioArray[c].getValue()}}if(d.region&&d.region.length>0){e.region=d.region}return e},render:function(d){var c=this;$("#"+c.renderId).html(c.mainItemHtml());c.bind();c.areaRender()}});a.clazz=b});M.define("searchlist",function(b){var a=function(c){this.init(c)};M.object.merge(a.prototype,{init:function(d){this.baseId="searchlist";this.renderId=d.renderId;this.listUlId=M.genId(this.baseId);this.loadDataId=M.genId(this.baseId);this.notFoundId=M.genId(this.baseId);this.pagenumId=M.genId(this.baseId);this.runtopId=M.genId(this.baseId);this.geToIndex=M.genId(this.baseId);this.goToTop=M.genId(this.baseId);this.keyword=d.keyword;this.page=1;this.allapge=0;this.hasData=true;this.baseParams=d.baseParams;this.canload=true;this.scrollEffective=true;if(d.scrollEffective==false){this.scrollEffective=false}else{this.scrollEffective=true}this.buriedPointVal=d.buriedPointVal;this.listUrl=d.listUrl?d.listUrl:"";this.searchParams="";this.searchParamsObj={};this.imgStaticSrc=d.imgStaticSrc?d.imgStaticSrc:"";this.isOrder=d.isOrder?true:false;this.orderIdList=[];this.imgLazyLad=new (M.exports("Imglazyload").clazz)();var c=0;if(!d.data||!d.data.wareList||d.data.wareList.length==0){$("#"+this.renderId).html(this.notFoundHtml());$("#"+this.notFoundId).show();this.hasData=false}else{$("body").addClass("loading");this.allapge=parseInt(d.data.wareCount/20,10);this.allapge=(d.data.wareCount%20)>0?(this.allapge+1):this.allapge;if(d.orderTitle&&this.isOrder){$("#"+this.renderId).before(this.orderTitleHtml(d.orderTitle))}$("#"+this.renderId).append(this.showDataUlHtml());$("#"+this.listUlId).html(this.showDataHtml(d.data));this.showDataBind();if(d.data.promotionID&&(d.data.promotionID=="1203"||d.data.promotionID=="1201")){if(d.data.promotionID=="1203"){$("#search_promotion").find("a").text("4免1")}else{if(d.data.promotionID=="1201"){$("#search_promotion").find("a").text("11.11")}}$("#search_promotion").attr("style","");$("#search_promotion").attr("promotionId",d.data.promotionID)}$("#"+this.renderId).append(this.notFoundHtml());$("#"+this.renderId).append(this.loadPageDataHtml());$("#"+this.renderId).append(this.runTopHtml());$("#"+this.pagenumId).text(this.page+"/"+this.allapge);this.page++;$("body").removeClass("loading");this.imgLazyLad.lazyLad()}},orderTitleHtml:function(e){var d=this;var c=[];c.push('<div class="sales-info-div">');c.push('<span class="sales-info">以下商品参加:'+e+"</span>");c.push("</div>");return c.join("")},runTopHtml:function(){var d=this;var c=[];c.push('<span id="'+d.runtopId+'" style="display:none;" class="search-back-up1 J_ping"  report-eventparam="" report-eventid="MList_BackToTop"></span>');return c.join("")},notFoundHtml:function(){var d=this;var c=[];c.push('<div style="display : none;" id="'+d.notFoundId+'" class="not-found">');c.push('<div class="notice">抱歉，没有找到符合条件的商品</div>');c.push("</div>");return c.join("")},loadPageDataHtml:function(){var d=this;var c=[];c.push('<div style="display : none;" id="'+d.loadDataId+'" class="swipe-up">');c.push('<div class="swipe-up-wrapper">');c.push('<div class="loading-con">');c.push('<span id="'+d.pagenumId+'" class="pagenum"></span>');c.push('<span class="loading"><i>加载中...</i></span>');c.push('<div class="clear"></div>');c.push("</div>");c.push("</div>");c.push("</div>");return c.join("")},showDataHtml:function(D){var u=this;var m=D.wareList;var u=this;var p=[];var n=u.searchParamsObj.region?u.searchParamsObj.region:[];var d=[];var v=["provinceId","cityId","countryId","townId"];var A={100:"享",5:"赠",1:"降",3:"券",4:"豆"};if(n&&n.length>0){for(var z=0,x=n.length;z<x;z++){d.push(v[z]+"="+n[z])}}d=d.length>0?"?"+d.join("&"):"";var f=M.cookie.getCookie("sid");f=f?f:"";if(m.length>0){for(var z=0,x=m.length;z<x;z++){var h="";var e=false;var s=false;var t=null;var l=0;var C=null;if(m[z].eche&&m[z].toMURL){h=m[z].toMURL}else{if(m[z].international){var k=d?(d+"&sid="+f):("?sid="+f);h="http://m.jd.hk/product/"+m[z].wareId+".html"+k}else{if(m[z].targetUrl){h=m[z].targetUrl;e=true;if(m[z].exposalUrl){var E=new Image();E.src=m[z].exposalUrl}}else{h="http://item.m.jd.com/product/"+m[z].wareId+".html"+d}}}if(m[z].promotionFlag&&m[z].promotionFlag.length>0){for(var B=0,o=m[z].promotionFlag.length;B<o;B++){if(m[z].promotionFlag[B]==100){s=true;break}}}if(m[z].priority=="1"){C="icon-hasbuy.png"}else{if(m[z].priority=="2"){C="icon-hasfocus.png"}}var q=u.buriedPointHtml(m[z],z);p.push('<li class="list-li-changeh">');if(u.isOrder){var t=M.genId(u.baseId);u.orderIdList.push(t);p.push("<span m_ware_id ="+m[z].wareId+" id="+t+' class="ladding-car J_ping" report-eventid="MShopcart_AddtoCart"  report-eventparam="'+m[z].wareId+'"></span>')}p.push("<a "+q+' style="text-decoration: none;" href="'+h+'">');if(m[z].stockState=="无货"){p.push('<div class="no-pro"></div>');p.push('<span class="no-pro-black">无货</span>')}p.push('<div class="list-thumb">');p.push('<img width="90" height="90"  imgsrc="'+m[z].imageurl.replace("/n4/","/n7/")+'" height="85" src="'+u.imgStaticSrc+'/images/search/thumb-avatar-170x170.png"></div>');p.push('<div class="list-descriptions">');p.push('<div class="list-descriptions-wrapper">');p.push('<div class="product-name name-changesize">'+m[z].wname+"</div>");p.push('<div class="price-spot price-spot-new spot-changemb">');if(m[z].disPrice&&l<2){p.push('<span class="product-new-vip vip-changem"><img class="icon-save" src="'+u.imgStaticSrc+'/images/search/icon-save.png"><span class="product-new-vip-info prodect-vip-info-change-padd">省'+m[z].disPrice+"元</span></span>");l=2}if(C&&l<2){l++;p.push('<span class="product-attention"><img width="50" height="16" src="'+u.imgStaticSrc+"/images/search/"+C+'"></span>')}if(!m[z].disPrice&&s&&l<2){l++;p.push('<span class="product-price globle-buy"><img width="55" height="16" src="'+u.imgStaticSrc+'/images/search/icon-vipprice.png"></span>')}if(m[z].international&&l<2){p.push('<span class="product-price globle-buy"><img width="55" height="16" src="'+u.imgStaticSrc+'/images/search/54f185c0Nc46e761a.png"></span>');l++}if(m[z].promotionFlag&&m[z].promotionFlag.length>0){for(var B=0,o=m[z].promotionFlag.length;B<o;B++){if(m[z].promotionFlag[B]==100){continue}p.push('<span class="little-icon">'+A[m[z].promotionFlag[B]]+"</span>")}}p.push("</div>");p.push('<span class="product-price">￥<span>'+m[z].jdPrice+"</span></span>");p.push('<div class="reputation reputation-unit">');p.push('<span class="ratings">'+m[z].good+"好评"+(m[z].totalCount?("&nbsp;&nbsp;&nbsp;"+m[z].totalCount+"人"):"")+"</span>");if(e&&!u.isOrder){p.push('<span class="sign-expand">推广</span>')}p.push("</div>");p.push("</div>");p.push("</div>");if(!u.isOrder){if(m[z].mPromotionId=="1203"){p.push('<img class="right-bottom-pic" src="'+u.imgStaticSrc+'/images/search/mian.png">')}else{if(m[z].mPromotionId=="1201"){p.push('<img class="right-bottom-pic" src="'+u.imgStaticSrc+'/images/search/daboule.png">')}}}p.push("</a>");p.push("</li>")}var y=null;if(u.page==1&&D.hotTagsMap&&D.hotTagsMap.length>=4){y=D.hotTagsMap}else{if(u.page==2&&D.hotTagsMapSpecial&&D.hotTagsMapSpecial.length>=4){y=D.hotTagsMapSpecial}}if(y&&y.length>0){var r=100;var c=8;if(y.length<8){r=60;c=4}p.push('<div class="recommend-lab"  style="height: '+r+'px">');for(var z=0;z<c;z++){if(z==0){p.push("<ul>")}else{if(z!=0&&z%4==0){p.push("</ul>");p.push("<ul>")}}p.push('<li><a style="text-decoration:none;color: #848689" href="/ware/search.action?keyword='+u.keyword+" "+y[z]+'"><span>'+y[z]+"</span></a></li>");if(z==(c-1)){p.push("</ul>")}}}}return p.join("")},showDataBind:function(){var c=this;if(c.orderIdList.length>0){for(;c.orderIdList.length>0;){var d=c.orderIdList.pop();$("#"+d).on("click",function(){var f=$(this).attr("m_ware_id");var g=M.cookie.getCookie("USER_FLAG_CHECK");var e=M.cookie.getCookie("sid");e=e?e:"";M.http.ajax({url:"http://p.m.jd.com/cart/add.json",data:"wareId="+f+"&num=1&USER_FLAG_CHECK="+g+"&sid="+e,success:function(h){var i=$("#alert").find("span");$(i).eq(0).attr("class","car-span-cor");$(i).eq(1).text("添加成功");$("#alert").fadeIn(200,function(){setTimeout(function(){$("#alert").fadeOut(200)},1000)})},error:function(){var h=$("#alert").find("span");$(h).eq(0).attr("class","car-span-err");$(h).eq(1).text("添加失败");$("#alert").fadeIn(200,function(){setTimeout(function(){$("#alert").fadeOut(200)},1000)})}})})}}},buriedPointHtml:function(f,c){var e=this;var d="";if(e.buriedPointVal=="search"){if(e.isOrder){d=' class="J_ping" report-eventid="MShopcart_Present"  report-eventparam="'+f.wareId+'" '}else{if(f.priority=="1"){d=' class="J_ping" report-eventid="MList_Purchased"  report-eventparam="'+f.wareId+'" '}else{if(f.priority=="2"){d=' class="J_ping" report-eventid="MList_Attention"  report-eventparam="'+f.wareId+'" '}else{if(f.targetUrl){d=' class="J_ping" report-eventid="MList_AdProducts"  report-eventparam="'+f.wareId+'" '}else{if(f.international){d=' class="J_ping" report-eventid="MList_Product"  report-eventparam="international" '}else{d=' class="J_ping" report-eventid="MList_Product"  report-eventparam="'+f.wareId+'" '}}}}}}else{if(e.buriedPointVal=="lookSimilar"){d=' class="J_ping" report-eventid="MHomeSimilarities_Products"  report-eventparam="'+c+"_"+f.wareId+'_1" '}}return d},showDataUlHtml:function(){var d=this;var c=[];c.push('<ul id="'+d.listUlId+'" class="list_body"></ul>');return c.join("")},load:function(){var c=this;$("#"+c.loadDataId).show();$("#"+c.notFoundId).hide();if(c.listUrl){var d=c.searchParams.replace(/\'/g,'"');M.http.ajax({url:c.listUrl,data:"_format_=json&"+d+"&page="+c.page+"&"+c.baseParams,success:function(e){var f=null;if(e&&e.value){f=$.parseJSON(e.value);c.allapge=parseInt(f.wareCount/20,10);c.allapge=(f.wareCount%20)>0?c.allapge+1:c.allapge;if(f.wareList&&f.wareList.length>0){$("#"+c.listUlId).append(c.showDataHtml(f));c.showDataBind();$("#"+c.listUlId).css({display:"block;"});$("#"+c.notFoundId).hide();$("#"+c.pagenumId).text(c.page+"/"+c.allapge);c.imgLazyLad.lazyLad()}c.page++}$("#"+c.loadDataId).hide();c.canload=true},error:function(){$("#"+c.loadDataId).hide();c.canload=true}})}},reload:function(e){var d=this;d.searchParamsObj=e;var f=d.createSearchParams(e);if(d.searchParams!=f){d.searchParams=f;$("body").addClass("loading");var c=d.baseParams.split("=");if(c.length<2||c[1]==""){$("body").removeClass("loading")}else{if(d.listUrl){var f=d.searchParams.replace(/\'/g,'"');M.http.ajax({url:d.listUrl,data:"_format_=json&"+f+"&page=1&"+d.baseParams,success:function(g){var h=null;$("#"+d.runtopId).hide();if(g&&g.value){h=$.parseJSON(g.value);d.allapge=parseInt(h.wareCount/20,10);d.allapge=(h.wareCount%20)>0?d.allapge+1:d.allapge;d.page=1;if(h.wareList&&h.wareList.length>0){$("#"+d.listUlId).html(d.showDataHtml(h));d.showDataBind();$("#"+d.listUlId).css({display:"block;"});$("#"+d.notFoundId).hide();$("#"+d.pagenumId).text(d.page+"/"+h.wareCount);d.page++;d.imgLazyLad.lazyLad();d.hasData=true}else{$("#"+d.listUlId).css({display:"none"});$("#"+d.notFoundId).show();d.hasData=false}}$("body").removeClass("loading")},error:function(){$("body").removeClass("loading");$("#"+d.runtopId).hide();$("#"+d.notFoundId).show();d.hasData=false;d.canload=true}})}}}},createSearchParams:function(d){var c=[];M.object.each(d,function(l,h){c.push(h);if(h!="region"){if(M.object.isArray(l)){c.push("=[");for(var f=0,e=l.length,k=e-1;f<e;f++){c.push(l[f]);if(f<k){c.push(",")}}c.push("]&")}else{c.push("=");c.push(l);c.push("&")}}else{if(l&&l.length>0){c.push("=");c.push(l[l.length-1]);c.push("&")}else{c.push("=");c.push("&")}}});return c.join("")},isReloadHasData:function(){var c=this;return c.hasData},closeLoad:function(){var c=this;c.scrollEffective=false},opendLoad:function(){var c=this;c.scrollEffective=true},listScrollBind:function(){var c=this;$(window).scroll(function(){c.imgLazyLad.lazyLad();if((c.page-1)<c.allapge&&$(window).scrollTop()>($("#"+c.renderId).height()-85*6)&&c.canload&&c.scrollEffective){$("#"+c.loadDataId).show();c.canload=false;c.load()}if($(window).scrollTop()>=$(window).height()){if(c.canload){$("#"+c.runtopId).show()}}else{$("#"+c.runtopId).hide()}});$(window).resize(function(){c.imgLazyLad.lazyLad()})},bind:function(){var c=this;c.listScrollBind();if(this.isOrder){$("#layout_urlblack").off();$("#layout_urlblack").on("click",function(){var d=M.cookie.getCookie("sid");window.location.href="http://p.m.jd.com/cart/cart.action?sid="+d})}$("#"+c.runtopId).on("click",function(){window.scrollTo(0,1)})},render:function(d){var c=this;c.bind()},run:function(){var c=this;c.bind()}});b.clazz=a});M.define("searchradio",function(a){var b=function(c){this.init(c)};M.object.merge(b.prototype,{init:function(c){this.text=c.text?c.text:"";this.key=c.key?c.key:"";this.id=c.id?M.genId("m_searchradio_"+c.id):M.genId("m_searchradio_");this.baseId=c.id?c.id:null;this.reportEventid=c.reportEventid?c.reportEventid:"";this.isCheck=c.isCheck?true:false},keepBefore:function(){var c=this;c.beforeIsCheck=c.isCheck},reBefore:function(){var c=this;if(c.isCheck!=c.beforeIsCheck){c.isCheck=c.beforeIsCheck;if(c.isCheck){$("#"+c.id).addClass("sel")}else{$("#"+c.id).removeClass("sel")}}},getValue:function(){var c=this;if(c.isCheck){return 1}else{return 0}},getKey:function(){var c=this;return c.key},getBaseId:function(){var c=this;return c.baseId},getId:function(){var c=this;return c.id},cancel:function(c){var d=this;d.secondChange=false;d.isCheck=false;if(c){$("#"+d.id).removeClass("sel")}},bind:function(c){var d=this;$("#"+d.id).on("click",function(){if(!d.isCheck){d.isCheck=true;$(this).addClass("sel")}else{$(this).removeClass("sel");d.isCheck=false}if(c){c(d)}})},html:function(){var e=this;var d="";if(e.reportEventid){d="J_ping"}if(e.isCheck){if(d){d=d+" sel"}else{d="sel"}}var c='<li style="" report-eventid="'+e.reportEventid+'" class="'+d+'" id="'+e.id+'"><em></em><span>'+e.text+"</span></li>";return c}});a.clazz=b});// JavaScript Document